version: '2.1'

services:

  bash:
    user: '1000:1000'
    image: smartweb/php:7.1-cli-dev
    entrypoint: 'bash'
    working_dir: '/var/www/html'
    environment:
      XDEBUG_CONFIG: idekey=PHPSTORM remote_host=192.168.1.167 remote_enable=1
      PHP_IDE_CONFIG: serverName=docker-codecept
    volumes:
      - .:/var/www/html
    networks:
      - webapps

  php-fpm:
    image: smartweb/php:7.1-fpm-dev
    volumes:
      - .:/var/www/html
      - ./setup/local/php-ext.ini:/usr/local/etc/php/conf.d/php-ext.ini
      - ./setup/local/xdebug.ini:/usr/local/etc/php/conf.d/xdebug-ext.ini
    networks:
      webapps:
        aliases:
          - php-app

  nats:
    image: nats
    ports:
      - "4222:4222"
      - "8222:8222"
    volumes:
      - .:/var/www/html
    networks:
      webapps:

  nats-streaming:
    image: nats-streaming
    volumes:
      - .:/var/www/html
    networks:
      webapps:

networks:
    webapps:
